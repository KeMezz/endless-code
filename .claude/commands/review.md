# Review Command

í˜„ì¬ PRì˜ ë¯¸í•´ê²° ë¦¬ë·° ì½”ë©˜íŠ¸ë¥¼ í•œ ë²ˆë§Œ ì²˜ë¦¬í•©ë‹ˆë‹¤. ë°˜ë³µ ì—†ì´ ë‹¨ì¼ ì‹¤í–‰.

## ì¸ì

- `$ARGUMENTS`: PR ë²ˆí˜¸ (ì„ íƒ). ì—†ìœ¼ë©´ í˜„ì¬ ë¸Œëœì¹˜ì˜ PR ìë™ ê°ì§€.

---

## ì‹¤í–‰ ì§€ì¹¨

### 1. PR ë° Repo ì •ë³´ í™•ì¸

```bash
# PR ì •ë³´
gh pr view ${ARGUMENTS} --json number,url,title,state,headRefName

# Repo ì •ë³´
gh repo view --json owner,name --jq '"\(.owner.login)/\(.name)"'
```

- PRì´ ì—†ê±°ë‚˜ closedë©´ ì¢…ë£Œ
- `OWNER/REPO`ì™€ `PR_NUMBER` ê¸°ë¡

### 2. ë¯¸í•´ê²° ë¦¬ë·° ì½”ë©˜íŠ¸ ìˆ˜ì§‘

#### 2.1 ì¸ë¼ì¸ ì½”ë©˜íŠ¸ (ë¯¸í•´ê²° ìŠ¤ë ˆë“œë§Œ)

GraphQLë¡œ ë¯¸í•´ê²° ë¦¬ë·° ìŠ¤ë ˆë“œ ìˆ˜ì§‘:

```bash
gh api graphql -f query='
query($owner: String!, $repo: String!, $pr: Int!) {
  repository(owner: $owner, name: $repo) {
    pullRequest(number: $pr) {
      reviewThreads(first: 100) {
        nodes {
          isResolved
          id
          comments(first: 10) {
            nodes {
              id
              databaseId
              author { login }
              body
              path
              line
              createdAt
            }
          }
        }
      }
    }
  }
}' -f owner="<OWNER>" -f repo="<REPO>" -F pr=<PR_NUMBER> \
  --jq '.data.repository.pullRequest.reviewThreads.nodes
    | map(select(.isResolved == false))
    | map({
        threadId: .id,
        comments: .comments.nodes | map(select(
          .author.login == "github-actions" or
          .author.login == "claude-bot" or
          .author.login == "copilot" or
          .author.login == "claude[bot]"
        )) | map({
          id: .databaseId,
          path: .path,
          line: .line,
          body: .body,
          created_at: .createdAt
        })
      })
    | map(select(.comments | length > 0))'
```

#### 2.2 ì¼ë°˜ ì½”ë©˜íŠ¸ (Bot ì‘ì„±, ìµœê·¼ 5ê°œ)

```bash
gh api repos/<OWNER>/<REPO>/issues/<PR_NUMBER>/comments \
  --jq '[.[] | select(
    .user.type == "Bot" or
    .user.login == "github-actions[bot]" or
    .user.login == "claude[bot]"
  ) | {
    type: "general",
    id: .id,
    body: .body,
    created_at: .created_at
  }] | sort_by(.created_at) | reverse | .[0:5]'
```

### 3. ì½”ë©˜íŠ¸ ì—†ìŒ í™•ì¸

ë¯¸í•´ê²° ì½”ë©˜íŠ¸ê°€ ì—†ìœ¼ë©´:

```
âœ… ì²˜ë¦¬í•  ë¦¬ë·° ì½”ë©˜íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.

PR: <URL>
```

ì¢…ë£Œ.

### 4. ì½”ë©˜íŠ¸ ëª©ë¡ ì¶œë ¥

```
## ë¯¸í•´ê²° ë¦¬ë·° ì½”ë©˜íŠ¸ ({N}ê°œ)

### ì¸ë¼ì¸ ì½”ë©˜íŠ¸
1. `path/to/file.swift:42` - ğŸ”´ Critical: nil ì²´í¬ ëˆ„ë½
2. `path/to/other.swift:15` - ğŸŸ¡ Warning: ë„¤ì´ë° ê°œì„  ê¶Œì¥

### ì¼ë°˜ ì½”ë©˜íŠ¸
1. ì „ë°˜ì ì¸ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„  í•„ìš”
```

### 5. ê° ì½”ë©˜íŠ¸ ì²˜ë¦¬

#### 5.1 ì‹¬ê°ë„ íŒŒì•…

ì½”ë©˜íŠ¸ bodyì—ì„œ ì‹¬ê°ë„ ì´ëª¨ì§€ í™•ì¸:
- ğŸ”´ **Critical**: ë°˜ë“œì‹œ ìˆ˜ì •
- ğŸŸ¡ **Warning**: ìˆ˜ì • ê¶Œì¥
- ğŸŸ¢ **Suggestion**: ì„ íƒì 

#### 5.2 Suggestion ë¸”ë¡ í™•ì¸

```markdown
```suggestion
ìˆ˜ì •ëœ ì½”ë“œ
```
```

ìˆìœ¼ë©´ í•´ë‹¹ ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì ìš© ê°€ëŠ¥.

#### 5.3 íƒ€ë‹¹ì„± ê²€í† 

ê° ì½”ë©˜íŠ¸ì— ëŒ€í•´:
1. í•´ë‹¹ íŒŒì¼/ë¼ì¸ ì½ê¸°
2. ì½”ë©˜íŠ¸ ë‚´ìš©ì˜ íƒ€ë‹¹ì„± íŒë‹¨
3. ìˆ˜ì • ì—¬ë¶€ ê²°ì •

| ì‹¬ê°ë„ | ê¸°ë³¸ í–‰ë™ |
|--------|----------|
| ğŸ”´ Critical | ACCEPT (ìˆ˜ì •) |
| ğŸŸ¡ Warning | ê²€í†  í›„ ê²°ì • |
| ğŸŸ¢ Suggestion | íƒ€ë‹¹í•˜ë©´ ACCEPT, ì•„ë‹ˆë©´ REJECT |

#### 5.4 ACCEPT: ì½”ë“œ ìˆ˜ì • + Resolve

**ì¸ë¼ì¸ ì½”ë©˜íŠ¸**:
1. íŒŒì¼ ì½ê¸° ë° ìˆ˜ì •
2. ìŠ¤í…Œì´ì§•: `git add <path>`
3. ë‹µê¸€:
   ```bash
   gh api repos/<OWNER>/<REPO>/pulls/comments/<COMMENT_ID>/replies \
     -f body="âœ… ìˆ˜ì • ì™„ë£Œ"
   ```
4. ìŠ¤ë ˆë“œ Resolve:
   ```bash
   gh api graphql -f query='
   mutation($threadId: ID!) {
     resolveReviewThread(input: {threadId: $threadId}) {
       thread { isResolved }
     }
   }' -f threadId="<THREAD_ID>"
   ```

**ì¼ë°˜ ì½”ë©˜íŠ¸**:
1. ì–¸ê¸‰ëœ íŒŒì¼ ìˆ˜ì •
2. ë¦¬ì•¡ì…˜ ì¶”ê°€:
   ```bash
   gh api repos/<OWNER>/<REPO>/issues/comments/<COMMENT_ID>/reactions \
     -f content="+1"
   ```

#### 5.5 REJECT: ì´ìœ  ì„¤ëª… + Resolve

**ì¸ë¼ì¸ ì½”ë©˜íŠ¸**:
```bash
# ë‹µê¸€
gh api repos/<OWNER>/<REPO>/pulls/comments/<COMMENT_ID>/replies \
  -f body="í˜„ì¬ êµ¬í˜„ì„ ìœ ì§€í•©ë‹ˆë‹¤.

**ì´ìœ **: <êµ¬ì²´ì  ì´ìœ >"

# ìŠ¤ë ˆë“œ Resolve
gh api graphql -f query='
mutation($threadId: ID!) {
  resolveReviewThread(input: {threadId: $threadId}) {
    thread { isResolved }
  }
}' -f threadId="<THREAD_ID>"
```

**ì¼ë°˜ ì½”ë©˜íŠ¸**:
```bash
gh pr comment <PR_NUMBER> --body "ë‹¤ìŒ í”¼ë“œë°±ì— ëŒ€í•´ í˜„ì¬ êµ¬í˜„ì„ ìœ ì§€í•©ë‹ˆë‹¤:

> <ì›ë³¸ ì½”ë©˜íŠ¸ ìš”ì•½>

**ì´ìœ **: <êµ¬ì²´ì  ì´ìœ >"
```

### 6. ì»¤ë°‹ ë° í‘¸ì‹œ

ìˆ˜ì •ëœ íŒŒì¼ì´ ìˆìœ¼ë©´:

```bash
git commit -m "$(cat <<'EOF'
fix: ë¦¬ë·° ë°˜ì˜

- <íŒŒì¼1>: <ìˆ˜ì • ë‚´ìš©>
- <íŒŒì¼2>: <ìˆ˜ì • ë‚´ìš©>

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>
EOF
)"

git push
```

### 7. ê²°ê³¼ ìš”ì•½

```
## ë¦¬ë·° ì²˜ë¦¬ ì™„ë£Œ

| í•­ëª© | ìˆ˜ |
|------|---|
| ì²˜ë¦¬ëœ ì½”ë©˜íŠ¸ | N |
| ìˆ˜ì • ë°˜ì˜ (ACCEPT) | A |
| ìœ ì§€ (REJECT) | R |
| Resolved ìŠ¤ë ˆë“œ | S |

### ì²˜ë¦¬ ìƒì„¸

| íŒŒì¼ | ë¼ì¸ | ê²°ì • | ë‚´ìš© |
|------|------|------|------|
| `file1.swift` | 42 | âœ… ACCEPT | nil ì²´í¬ ì¶”ê°€ |
| `file2.swift` | 15 | âŒ REJECT | í˜„ì¬ ë„¤ì´ë°ì´ ë” ëª…í™•í•¨ |

PR: <URL>
```

---

## ì²˜ë¦¬ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. PR ì •ë³´ í™•ì¸                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ë¯¸í•´ê²° ì½”ë©˜íŠ¸ ìˆ˜ì§‘ (GraphQL)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ ì½”ë©˜íŠ¸ ìˆìŒ?   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        No        â”‚        Yes
          â–¼       â”‚         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ "ì²˜ë¦¬í•      â”‚   â”‚  â”‚  3. ê° ì½”ë©˜íŠ¸ íƒ€ë‹¹ì„± ê²€í†              â”‚
â”‚  ì½”ë©˜íŠ¸     â”‚   â”‚  â”‚     - íŒŒì¼/ë¼ì¸ ì½ê¸°                  â”‚
â”‚  ì—†ìŒ"      â”‚   â”‚  â”‚     - ì½”ë©˜íŠ¸ ë¶„ì„                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚     - ACCEPT/REJECT ê²°ì •            â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â–¼
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  â”‚  4. ìˆ˜ì • ì ìš© + ìŠ¤ë ˆë“œ Resolve        â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â–¼
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  â”‚  5. ì»¤ë°‹ & í‘¸ì‹œ                       â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â–¼
                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  â”‚  6. ê²°ê³¼ ìš”ì•½ ì¶œë ¥                    â”‚
                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì‚¬ìš© ì˜ˆì‹œ

```bash
# í˜„ì¬ ë¸Œëœì¹˜ PRì˜ ë¦¬ë·° ì²˜ë¦¬
/review

# íŠ¹ì • PR ë¦¬ë·° ì²˜ë¦¬
/review 42
```

## review vs review-loop ë¹„êµ

| í•­ëª© | /review | /review-loop |
|------|---------|--------------|
| ì‹¤í–‰ íšŸìˆ˜ | 1íšŒ | ë¯¸í•´ê²° ì½”ë©˜íŠ¸ ì—†ì„ ë•Œê¹Œì§€ |
| ë¦¬ë·° ìš”ì²­ | ì•ˆ í•¨ | `@claude ë¦¬ë·°` ìë™ ìš”ì²­ |
| ì‚¬ìš© ì‹œì  | ë¦¬ë·° ì´ë¯¸ ì™„ë£Œë¨ | ë¦¬ë·° ìš”ì²­ë¶€í„° ì‹œì‘ |
| ìë™í™” ìˆ˜ì¤€ | ë‚®ìŒ | ë†’ìŒ (stop hook) |
